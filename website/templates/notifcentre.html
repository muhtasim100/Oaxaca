{% extends "base.html" %}
{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/notifcenter.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/Foodeditui.css') }}">
<title>
  Oaxaca - Notification Center
</title>
{% endblock %}

{% block content %}
<div class="notifs-content">
  {% for notif in res %}
  <div class="action" id="{{ notif.NotificationID }}">
    <div class="user-img"><img src="{{ url_for('static', filename='images/User-Icon.svg') }}" alt="user"></div>

    {% if notif.typeNotification == 1 %}
    <div class="light-img"><img src="{{ url_for('static', filename='images/red-light.svg') }}" alt="redlight"></div>
    {% endif %}

    {% if notif.typeNotification == 2 %}
    <div class="light-img"><img src="{{ url_for('static', filename='images/yellow-light.svg') }}" alt="redlight"></div>
    {% endif %}

    {% if notif.typeNotification == 3 %}
    <div class="light-img"><img src="{{ url_for('static', filename='images/green-light.svg') }}" alt="redlight"></div>
    {% endif %}

    <div class="notif-text"> Table {{ notif.FK_UserID }}
      {% if notif.typeNotification == 1 %}
      has ordered
      {% endif %}

      {% if notif.typeNotification == 2 %}
      has called the waiter
      {% endif %}

      {% if notif.typeNotification == 3 %}
      has paid
      {% endif %}

      {% if notif.typeNotification == 4 %}
      Customer has left
      {% endif %}

      <br>
      {{ notif.TimeNotifcation }}
    </div>
    <div class="notif-img"><img src="{{ url_for('static', filename='images/clickarrow.svg') }}" alt="arrow"></div>
    <!-- <img class="delete-button" src="{{ url_for('static', filename='images/delete.png') }}" alt="delete-button"> -->
    <div class="delete-button"><img src="{{ url_for('static', filename='images/delete.png') }}" alt="delete-button"></div>
  </div>
  {% endfor %}

</div>

<!-- <script type="text/javascript">
  function TimeAgo(){
    const date = new Date();

    let day = date.getDate();
    let month = date.getMonth() + 1;
    let year = date.getFullYear();
    let hour = date.getHours();
    let minutes = date.getMinutes();
    let seconds =  date.getSeconds();

    let currentDate = `${day}-${month}-${year}--${hour}--${minutes}--${seconds}`;
    document.getElementById("time-ago").innerHTML = currentDate;
  }
  TimeAgo();
</script> -->


<script>
  let notif_div = Array.from(document.querySelectorAll(".action"));
  notif_div.forEach(function (action) {
    let delete_button = action.querySelector(".delete-button");
    if (delete_button) {
      action.onmouseover = function() {
        delete_button.style.visibility = "visible";
      }
      action.onmouseout = function() {
        delete_button.style.visibility = "hidden";
      }

      delete_button.onclick = function() {
        $.ajax({
          url: '/delete_notif',
          type: 'POST',
          data: {id: action.id},
          success: function(data) {
            $(".content").prepend('<div class="notification"><div class="notification-message"></div></div>');
            $(".notification-message").html("Notification deleted!");
          },
          error: function(error) {
            console.log(error);
          }
        });
        action.remove();
      }
    }
  });
</script>

{% endblock %}